<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
  <h2>üéâ –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
  <p class="result">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span id="score"></span></p>

  <!-- –ó–≤—É–∫–∏ -->
  <audio id="applause" src="{{ url_for('static', filename='applause.mp3') }}"></audio>
  <audio id="victory" src="{{ url_for('static', filename='victory.mp3') }}"></audio>
</div>

<script>
window.onload = () => {
  const score = Number(localStorage.getItem("score"));
  const name = localStorage.getItem("username");
  const totalQuestions = localStorage.getItem("totalQuestions"); // –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ quiz.html

  document.getElementById("score").innerText = `${score}`;

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π –∑–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
  const applause = document.getElementById("applause");
  const victory = document.getElementById("victory");

  if (totalQuestions && score === Number(totalQuestions)) {
    // –í—Å–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ‚Üí –∑–≤—É–∫ –ø–æ–±–µ–¥—ã
    victory.volume = 0.8;
    victory.play();
  } else {
    // –ü—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∏–ª —Ç–µ—Å—Ç ‚Üí –∞–ø–ª–æ–¥–∏—Å–º–µ–Ω—Ç—ã
    applause.volume = 0.7;
    applause.play();
  }

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
  fetch("/results", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name: name, score: score })
  });
};
</script>
</body>
</html>
