<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Radiology Quiz</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
  <h2>ðŸ§  Ð’Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð° Ð¿Ð¾ ÐšÐ¢</h2>
  <div id="timer" class="timer">15</div>
  <div id="question"></div>
  <div id="options"></div>
  <div id="result"></div>
</div>

<script>
const questions = {{ questions|tojson }};
let current = 0, score = 0, timeLeft = 15, timer;

localStorage.setItem("totalQuestions", questions.length);
  
  function showQuestion() {
  if (current >= questions.length) {
    localStorage.setItem("score", score);
    window.location.href = "/results";
    return;
  }

  document.getElementById("result").innerHTML = "";
  let q = questions[current];
  document.getElementById("question").innerHTML = `<h3>${q.question}</h3>`;
  let opts = "";
  q.options.forEach(o => {
    opts += `<button onclick="checkAnswer('${o}')">${o}</button>`;
  });
  document.getElementById("options").innerHTML = opts;
  
  timeLeft = 15;
  document.getElementById("timer").innerText = timeLeft;
  clearInterval(timer);
  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("timer").innerText = timeLeft;
    if (timeLeft <= 0) {
      clearInterval(timer);
      current++;
      showQuestion();
    }
  }, 1000);
}

function checkAnswer(ans) {
  if (ans === questions[current].answer) {
    score++;
    document.getElementById("result").innerText = "âœ… Ð’ÐµÑ€Ð½Ð¾!";
  } else {
    document.getElementById("result").innerText = "âŒ ÐÐµÐ²ÐµÑ€Ð½Ð¾!";
  }
  clearInterval(timer);
  setTimeout(() => { current++; showQuestion(); }, 1000);
}

showQuestion();
</script>
</body>
</html>
